 <!DOCTYPE html
 PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>

  <head>
    <meta charset="utf-8">
  <link type="text/css" rel="stylesheet" href="stylesheet.css"/>
  <title>Language Tandem Analysis - men vs women</title>
<!--script src="default_data.js"></script-->
<script src="data_mf.js"></script>
<style>
  .row  {margin: 30px; display: inline-block;}
  .cell {margin:  0px; display: inline-block;}
  .t {clear:both}
  .b {float:left}
  .title {width:inherit;  clear:both}
  .down { margin-top: 4mm }
  h2 {text-align:center}
  .alignright { text-align: right; }
</style>
 </head>

 <body>
   <div id="container" style="width: 75%;margin: auto;">
     <p id="pretext">
       Users placing ads are asked to input a salutation: either "Mrs. /Ms.", "Mr. ", or it can be left out. <br>
       #entries_men users chose "Mr. " henceforth referenced as men. <br>
       #entries_women users chose "Mrs. /Ms." henceforth referenced as women <br>
       #entries_other users didn't chose either. (at the time of writing/coding there were too few (16) to draw any meaningful conclusions, so I didn't investigate them any further)
     </p>
     <h2>Frequency of postings by day of the week</h2>
   <canvas id="entries_by_day_of_week" ></canvas>
   <p id="posttext">
    Do the frequencies of men and women stem from the same distribution? Chi square test has a p-value of: #p_val</p>
  </div>
  <div id="container" style="width: 100%;">
    <h2>Frequency of postings by day of the year</h2>
  </div>
  <br>  <hr>  <br>
  Let's look at the number of languages people offer
  <table  id='lang_table'></table>
  <p id="lang_text" align='left'>#want_more people are looking for more languages than they are offering, <br>
      #offer_more people are offering to teach more languages then they are looking to learn and <br>
	#same people are looking for as many languages as they are offering. <br>
	The average person is looking to learn #lang_expected_demand and offering #lang_expected_supply languages.
  </p>
  Let's look at the distribution of languages
    
  <div id="search_blocks_div" style="width: 100%;">
    <canvas id="searching"></canvas>  <br>
    <table id="search_table"></table>
  </div>
  <div id="offer_blocks_div"  style="width: 100%;">
    <canvas id="offering"></canvas> <br>
    <table id="offer_table"></table>
  </div>
  <br>  <hr>  <br>
  <br>  <hr>  <br> 
  <div class="row"> <!-- overall most popular -->
    <div id ="t1" class="title">Overall men,<br> number of people searching for/ offering a language</div>
    <div id="down1" class="down">
      <div class="cell">
        demand<br>
        <table  id='t_overall_d' class="t"></table> 
      </div>
      <div class="cell">
        supply<br>
        <table  id='t_overall_s' class="t"></table> 
      </div>
    </div>
  </div>

  <div class="row"> <!-- women -->
    <div id ="t2" class="title">Overall women<br>number of people searching for/ offering a language</div>
    <div id="down1" class="down">
      <div class="cell">
        demand<br>
        <table  id='t_first_d' class="t"></table> 
      </div>
      <div class="cell">
        supply<br>
        <table  id='t_first_s' class="t"></table> 
      </div>
    </div>
  </div>


<br>  <hr>  <br>
	<p id="entropy">
	Let's say we want to guess whether a random entry was made by a man or a woman.<br>
	We are allowed to ask "Does the entry offer language X". Then it is best to ask about #offer_lang.<br>
	It will decrease entropy from #offer_from to #offer_to.<br>
        If we are instead allowed to ask for one language <em>searched</em> for, it is best to ask about #demand_lang.<br>
	It will decrease entropy from #demand_from to #demand_to.<br>
	</p>
<br>  <hr>  <br>
        <p id="language_choices">
	Do men and women differ in their choice of languages to learn/offer?<br>
	We look at languages that have more than 5 occurrences in at least one gender.<br>
	For languages <em>offered</em>, a chi-square test for homogeneity yields a p value of #p_offer.
	For languages <em>searched</em> for, a chi-square test for homogeneity yields a p value of #p_search.
	</p>
<br>  <hr>  <br>
        <link type="text/css" rel="stylesheet" href="stylesheet_force.css"/>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
      <br>  <hr>  <br>
	    
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>


<script >
//schema table_overall_d_m
  
  var t_id = []
  var l_id = []
  for (n of ['overall', 'first', 'additional','last']){
      t_id.push('t_'+n+'_d')
      t_id.push('t_'+n+'_s')
  }

  var s_tables = t_id.map( x => document.getElementById(x));
		    

function setDivWidth(){
    list_ids = ["t1","t2","t3","t4"]
    boxes = list_ids
    for (id of boxes){
        e= document.getElementById(id)
        e.setAttribute("style","width:0px;");
        w=e.parentElement.children[1].offsetWidth
        sum=w+"px"
        e.setAttribute("style","width:"+sum+"; clear:both");
        //e.style.width=sum;
        //https://stackoverflow.com/questions/10118172/setting-div-width-and-height-in-javascript
    }
    return 3;
}
    
  var insert_rough_data = function() {
    var p = document.getElementById("pretext");
    p.innerHTML = p.innerHTML.replace("#entries_men",   entries_men)
                             .replace("#entries_women", entries_women)
                             .replace("#entries_other", entries_other)  ;
    var po = document.getElementById("posttext");
    if(weekday_chi < 0.05){ var text = " → we assume they don't." }
		     else { var text = " → we assume they do."}
    po.innerHTML = po.innerHTML.replace("#p_val",  weekday_chi+text);

    var p = document.getElementById("entropy");

    p.innerHTML = p.innerHTML.replace("#offer_lang", _lang_plural(infogain_offer.languages))
                             .replace("#offer_from", infogain_offer.from)
                             .replace("#offer_to",   infogain_offer.to);

    p.innerHTML = p.innerHTML.replace("#demand_lang", _lang_plural(infogain_search.languages))
                             .replace("#demand_from", infogain_search.from)
                             .replace("#demand_to",   infogain_search.to);

    var p = document.getElementById("language_choices");
    p.innerHTML = p.innerHTML.replace("#p_offer",  _lang_pvalue(pval_mf_offer) )
                             .replace("#p_search", _lang_pvalue(pval_mf_search));
    
  }
  var _lang_plural = function(arr) {
    l = arr.length
    if (l == 0) {
       console.log("infogain_??.languages are empty?!")
    } else if (l == 1) {
       return arr[0]
    } else {
       return "either " + arr.slice(0, l-1).join(', ') + " or " + arr[l-1]
    }
  
  }
  var _lang_pvalue = function(p) {
    if (p < 0.05) {
       return p + " leading us to believe that men/women have different distributions"
    } else {
       return p + " leading us to believe that language choices are distributed equally"
    }
  }
  
		    
		    

  var onload_rank =   function() {
    //var t = document.getElementById("table_amortized_demand"); t.innerHTML = table_remaining_dem;
    //var t = document.getElementById("table_amortized_supply"); t.innerHTML = table_remaining_sup;
  
    var t = document.getElementById("t_overall_d"); t.innerHTML = table_overall_d_m;
    var t = document.getElementById("t_overall_s"); t.innerHTML = table_overall_s_m;
  
    var t = document.getElementById("t_first_d");   t.innerHTML = table_overall_d_f;
    var t = document.getElementById("t_first_s");   t.innerHTML = table_overall_s_f;
            
  }
    
  window.onload = function() {
    insert_rough_data();
    onload_rank();
    
/*    var t = document.getElementById("lang_table");
    t.innerHTML = lang_tablecontent
    var p = document.getElementById("lang_text");
    p.innerHTML = p.innerHTML.replace("#want_more", lang_want_more)
                             .replace("#same",      lang_same)
                             .replace("#offer_more",lang_offer_more)
                             .replace("#lang_expected_demand", lang_expected_demand)
                             .replace("#lang_expected_supply", lang_expected_supply);
*/      
      setDivWidth();
  }
  


  //var week_day_all =  [12, 19, 3, 5, 2, 3,3]
</script>
<script src="bar_charts_mf.js"></script>

  
 </body>
</html>
